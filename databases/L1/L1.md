## 1
### Wypisz wszystkie znajduj  ̨ace si ̨e w bazie tabele oraz wy ́swietl struktur ̨e wybranej tabeli
```sql
SHOW TABLES;
DESCRIBE language;
```
## 2
### Wypisz tytuły filmów o długo ́sci wi ̨ekszej ni ̇z 2 godziny
```sql
SELECT title length FROM film WHERE length > 120;
```

## 3
### Wypisz tytuły 4 najkrótszych filmów o kategorii wiekowej PG-13
```sql
SELECT title
FROM film
WHERE rating = 'PG-13'
ORDER BY length ASC
LIMIT 4;
```

## 4
### Wypisz tytuły filmów z kategorii wiekowej PG-13 o czterech najmniejszych ró ̇znych długo ́sciach
```sql
SELECT title
FROM film
WHERE rating = 'PG-13'
GROUP BY length
ORDER BY length ASC
LIMIT 4;
```

## 5
### Wypisz tytuły filmów oraz ich j ̨ezyk, dla wszystkich filmów, w których opisie wyst ̨epuje słowo Drama
```sql
SELECT language_id, title
FROM film
WHERE title LIKE "%drama%";
```

## 6
### Wypisz tytuły filmów z kategorii Family, które w swoim opisie zawieraj  ̨a słowo Documentary
```sql
SELECT DISTINCT f.title
FROM film f 
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Family'
    AND f.description LIKE '%Documentary%';
```

## 7
### Wypisz tytuły filmów z kategorii Children, które nie nale ̇z  ̨a do kategorii wiekowej PG-13
```sql
SELECT f.title
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE (
    c.name = "Children" AND
    f.rating =! "PG-13"
);
```

## 8
### Dla ka ̇zdej kategorii wiekowej filmów (G, PG-13, PG, NC-17, R) wypisz liczb ̨e filmów do niej nale ̇z  ̨acych
```sql
SELECT f.rating, COUNT(*)
FROM film f
WHERE f.rating IN ('G','PG','PG-13','R','NC-17')
GROUP BY rating;
```


## 9
### Wypisz tytuły filmów wypo ̇zyczonych pomi ̨edzy 31 maja a 30 czerwca 2005. Wyniki posortuj w odwrotnej kolejno ́sci alfabetyczne
```sql
SELECT f.title
FROM rental r
JOIN inventory i ON r.inventory_id = i.inventory_id
JOIN film f ON i.inventory_id = f.film_id
WHERE r.rental_date BETWEEN '2005-05-31' AND '2005-06-30 23:59:59'
ORDER BY f.title DESC;
```

## 10
### Wypisz imiona i nazwiska wszystkich aktorów, którzy wyst  ̨apili w filmach zawieraj  ̨acych usuni ̨ete sceny
```sql
SELECT DISTINCT first_name, last_name
FROM actor a
JOIN film_actor fa ON fa.actor_id = a.actor_id
JOIN film f ON fa.film_id = f.film_id
WHERE FIND_IN_SET('Deleted Scenes', special_features);
```

## 11
### Wypisz bez powtórze  ́n identyfikatory, imiona oraz nazwiska wszystkich klientów, których wypo ̇zyczenie i odpowiadaj  ̨aca mu płatno ́s ́c były obsłu ̇zone przez 2 ró ̇znych pracowników
```sql
SELECT DISTINCT c.customer_id, c.first_name, c.last_name
FROM customer c
JOIN rental r ON r.customer_id = c.customer_id
JOIN payment p ON p.rental_id = r.rental_id
WHERE r.staff_id <> p.staff_id;
```

## 12
### Policz, ilu klientów wypo ̇zyczyło wi ̨ecej filmów ni ̇z klient o e-mailu MARY.SMITH@sakilacustomer.org.
```sql
SELECT COUNT(*)
FROM (
    SELECT c.customer_id, COUNT(r.rental_id) AS rentals
    FROM customer c
    JOIN rental r ON r.customer_id = c.customer_id
    GROUP BY c.customer_id
) AS sub
WHERE sub.rentals < (
    SELECT COUNT(*)
    FROM customer c2
    JOIN rental r2 ON r2.customer_id = c2.customer_id
    WHERE c2.email = 'MARY.SMITH@sakilacustomer.org'
);
```

## 13
### Wypisz wszystkie pary ró ̇znych aktorów, którzy wyst  ̨apili razem w wi ̨ecej ni ̇z jednym filmie. Ka ̇zda para powinna wyst ̨epowa ́c co najwy ̇zej raz. Je ́sli wyst ̨epuje para (X,Y ), to nie wypisuj pary (Y, X). Zacznij od wylistowania par identyfikatorów takich aktorów a nast ̨epnie zamiast par identyfikatorów wypisz imiona i nazwiskach tych aktorów oraz liczb ̨e filmów, w których zagrali razem. Zastanów si ̨e, co si ̨e stanie,je ̇zeli mamy dwóch ró ̇znych aktorów o tym samym imieniu i nazwisku
```sql
SELECT first_name last_name
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id
JOIN film ON 
```

## 14
### Wypisz nazwiska aktorów, którzy nie wyst  ̨apili w  ̇zadnym filmie, którego tytuł zaczyna si ̨e liter  ̨a C
```sql
SELECT a.last_name, a.first_name
FROM actor a
WHERE NOT EXISTS (
  SELECT 1
  FROM film_actor fa
  JOIN film f ON fa.film_id = f.film_id
  WHERE fa.actor_id = a.actor_id
    AND f.title LIKE 'C%'
)
ORDER BY a.last_name, a.first_name;
```

## 15
### Wypisz nazwiska aktorów, którzy zagrali w wi ̨ekszej liczbie horrorów ni ̇z filmów akcji
```sql
SELECT a.first_name, a.last_name,
       SUM(CASE WHEN c.name = 'Horror' THEN 1 ELSE 0 END) AS horror_count,
       SUM(CASE WHEN c.name = 'Action' THEN 1 ELSE 0 END) AS action_count
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id
JOIN film_category fc ON fa.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
GROUP BY a.first_name, a.last_name
HAVING SUM(CASE WHEN c.name = 'Horror' THEN 1 ELSE 0 END) > SUM(CASE WHEN c.name = 'Action' THEN 1 ELSE 0 END)
ORDER BY horror_count;
```

## 16
### Wypisz wszystkich klientów, których  ́srednia opłata za wypo ̇zyczony film jest ni ̇zsza ni ̇z  ́srednia opłata dokonana 30 lipca 2005
```sql
-- średnia opłata w dniu 2005-07-30
SELECT AVG(amount) AS avg_on_20050730
FROM payment
WHERE DATE(payment_date) = '2005-07-30';

-- klienci o średniej opłacie mniejszej niż powyżej
WITH avg_day AS (
  SELECT AVG(amount) AS day_avg
  FROM payment
  WHERE DATE(payment_date) = '2005-07-30'
),
customer_avg AS (
  SELECT p.customer_id, AVG(p.amount) AS cust_avg
  FROM payment p
  GROUP BY p.customer_id
)
SELECT c.customer_id, c.first_name, c.last_name, ca.cust_avg
FROM customer_avg ca
JOIN customer c ON ca.customer_id = c.customer_id
JOIN avg_day ad ON 1=1
WHERE ca.cust_avg < ad.day_avg
ORDER BY ca.cust_avg;
```

## 17
### Zmie  ́n j ̨ezyk filmu YOUNG LANGUAGE na włoski
```sql
-- Jeżeli nie ma włoskiego, dodaj:
INSERT INTO language (name) SELECT 'Italian' WHERE NOT EXISTS (SELECT 1 FROM language WHERE name = 'Italian');

-- Aktualizacja filmu
UPDATE film
SET language_id = (SELECT language_id FROM language WHERE name = 'Italian' LIMIT 1)
WHERE title = 'YOUNG LANGUAGE';
```

## 18
### Dodaj do tabeli language j ̨ezyk hiszpa  ́nski i zmie  ́n j ̨ezyk wszystkich filmów, w których wyst ̨epuje ED CHASE na hiszpa  ́nski
```sql
-- 1) dodaj język hiszpański jeśli nie istnieje
INSERT INTO language (name) SELECT 'Spanish' WHERE NOT EXISTS (SELECT 1 FROM language WHERE name = 'Spanish');

-- 2) aktualizacja
UPDATE film
SET language_id = (SELECT language_id FROM language WHERE name = 'Spanish' LIMIT 1)
WHERE film_id IN (
  SELECT DISTINCT fa.film_id
  FROM film_actor fa
  JOIN actor a ON fa.actor_id = a.actor_id
  WHERE a.first_name = 'ED' AND a.last_name = 'CHASE'
);
```

## 19
### Do tabeli language dodaj kolumn ̨e films_no i uzupełnij j  ̨a liczb  ̨a filmów w danym j ̨ezyku
```sql
ALTER TABLE language ADD COLUMN films_no INT DEFAULT 0;

UPDATE language l
SET films_no = (
  SELECT COUNT(*)
  FROM film f
  WHERE f.language_id = l.language_id
);
```

## 20
### Usu  ́n kolumn ̨e release_year z tabeli film.
```sql
ALTER TABLE film DROP COLUMN release_year;
```